## Traceroute



With ping, you now have a way to determine if you can reach a certain computer from another one. You can also understand the general quality of the connection. But communications across networks, especially across the Internet usually, cross lots of intermediary nodes. Sometimes, you need a way to determine where in the long chain of router hops the problems actually are. Traceroute to the rescue. Traceroute is an awesome utility that lets you discover the paths between two nodes, and gives you information about each hop along the way. The way traceroute works, is through a clever manipulation technique of the TTL field at the IP level. We learned earlier that the TTL field is decremented by one, by every router that forwards the packet. When the TTL field reaches zero, the packet is discarded and an ICMP Time Exceeded message is sent back to the originating host. Traceroute uses the TTL field by first setting it to one for the first packet, then two for the second, three for the third and so on. By doing this clever little action, traceroute makes sure that the very first packet sent will be discarded by the first router hop. This results in an ICMP Time Exceeded message, the second packet will make it to the second router, the third will make it to the third, and so on. This continues until the packet finally makes it all the way to its destination. For each hop, traceroute will send three identical packets. Just like with ping, the output of a traceroute command is pretty simple. On each line, you'll see the number of the hop and the round trip time for all three packets. You will also see the IP of the device at each hop, and a host name if traceroute can resolve one. On Linux and MacOS, traceroute sends UDP packets to very high port numbers. On Windows, the command has a shortened name tracert, and defaults to using ICMP echo request. On all platforms, traceroute has more options than can be specified using command line flags. Two more tools that are similar to traceroute are mtr on Linux and MacOS and pathping on Windows. These two tools act as long running traceroutes. So you can better see how things change over a period of time. Mtr works in real time and will continually update its output with all the current aggregate data about the traceroute. You can compare this with pathping, which runs for 50 seconds and then displays the final aggregate data all at once.



使用 ping 功能，您现在可以 确定是否可以从另一台计算机访问某台计算机。 您还可以了解连接的一般质量。 但是，跨网络的通信， 尤其是互联网的通信通常 会跨越许多中间节点。 有时，您需要一种方法来确定在 长链路由器跳点中问题的实际位置。 跟踪路线去救援 T@@ raceroute 是一个令人敬畏的实用程序，可以让你发现两个节点之间的路径， 并为你提供有关沿途的每一跳的信息。 traceroute 的工作方式 是通过 IP 级别的 TTL 领域的巧妙操纵技术。 我们之前了解到，TTL 字段 由每个转发数据包的路由器递减 1。 当 TTL 字段达到零时， 数据包将被丢弃 ，并将 ICMP 超时消息发送回原始主机。 T@@ raceroute 使用 TTL 字段，方法是先将第一个数据包设置为 1，然后将第二个数据包设置为 2 个，第三个数据包三个，依此类推。 通过做这个巧妙的小动作， traceroute 确保 发送的第一个数据包将被第一个路由器跳丢弃。 这将导致 ICMP 超时消息，第 二个数据包将发送到第二个路由器， 第三个数据包将到达第三个数据包，依此类推。 这种情况一直持续到数据包最终使其一直到达目的地为止。 对于每一跳，traceroute 将发送三个相同的数据包。 就像 ping 一样，traceroute 命令的输出非常简单。 在每行上，您将看到 所有三个数据包的跳数和往返时间。 您还将在每个跳处看到设备的 IP， 如果 traceroute 可以解析一个，则会看到一个主机名。 在 Linux 和 macOS 上， 跟踪路由将 UDP 数据包发送到非常高的端口号。 在 Windows 上，该命令具有缩短的名称 tracert ，默认为使用 ICMP 回显请求。 在所有平台上，traceroute 的 选项多于使用命令行标志指定的选项。 另 外两个类似于跟踪路由的工具是在 Linux 和 macOS 上进行地址和在 Windows 上的路径。 这两个工具充当长时间运行的跟踪线。 所以你可以更好地看到事情在一段时间内是如何变化的。 地铁实时工作，并将不断更新 其输出与 traceroute 的所有当前汇总数据。 您可以将其与路径进行比较 ，后者运行 50 秒，然后一次显示所有最终的聚合数据。