## TCP Control Flags and the Three-way Handshake

As a protocol, TCP establishes connections used to send long chains of segments of data. You can contrast this with the protocols that are lower in the networking model. These include IP and Ethernet, which just send individual packets of data. As an IT support specialist, you need to understand exactly how that works, so you can troubleshoot issues, where network traffic may not be behaving in the expected manner. The way TCP establishes a connection, is through the use of different TCP control flags, used in a very specific order. Before we cover how connections are established and closed, let's first define the six TCP control flags. We'll look at them in the order that they appear in a TCP header. Heads up. This isn't necessarily in the same order of how frequently they're set, or how important they are. The first flag is known as URG, this is short for Urgent. A value of one here indicates that the segment is considered urgent and that the urgent pointer field has more data about this. Like we mentioned in the last video, this feature of TCP has never really had wide spreaded option and isn't normally seen. The second flag is ACK, short for acknowledge. A value of one in this field means that the acknowledgment number field should be examined. The third flag is PSH, which is short for Push. This means, that the transmitting device wants the receiving device to push currently- buffered data to the application on the receiving end as soon as possible. A buffer is a computing technique, where a certain amount of data is held somewhere, before being sent somewhere else. This has lots of practical applications. In terms of TCP, it's used to send large chunks of data more efficiently. By keeping some amount of data in a buffer, TCP can deliver more meaningful chunks of data to the program waiting for it. But in some cases, you might be sending a very small amount of information, that you need the listening program to respond to immediately. This is what the push flag does. The Fourth flag is RST, short for Reset. This means, that one of the sides in a TCP connection hasn't been able to properly recover from a series of missing or malformed segments. It's a way for one of the partners in a TCP connection to basically say, "Wait, I can't put together what you mean, let's start over from scratch." The fifth flag is SYN, which stands for Synchronize. It's used when first establishing a TCP connection and make sure the receiving end knows to examine the sequence number field. And finally, our six flag is FIN, which is short for Finish. When this flag is set to one, it means the transmitting computer doesn't have any more data to send and the connection can be closed. For a good example of how TCP control flags are used, let's check out how a TCP connection is established. Computer A will be our transmitting computer and computer B will be our receiving computer. To start the process off, computer A, sends a TCP segment to computer B with this SYN flag set. This is computer A's way of saying, "Let's establish a connection and look at my sequence number field, so we know where this conversation starts." Computer B then responds with a TCP segment, where both the SYN and ACK flags are set. This is computer B's way of saying, "Sure, let's establish a connection and I acknowledge your sequence number." Then computer A responds again with just the ACK flag set, which is just saying, "I acknowledge your acknowledgement. Let's start sending data." I love how polite they are to each other. This exchange involving segments that have SYN, SYN/ACK and ACK sets, happens every single time a TCP connection is established anywhere. And is so famous that it has a nickname. The three way handshake. A handshake is a way for two devices to ensure that they're speaking the same protocol and will be able to understand each other. Once the three way handshake is complete, the TCP connection is established. Now, computer A is free to send whatever data it wants to computer B and vice versa. Since both sides have now sent SYN/ACK pairs to each other, a TCP connection in this state is operating in full duplex. Each segment sent in either direction should be responded to by TCP segment with the ACK field set. This way, the other side always knows what has been received. Once one of the devices involved with the TCP connection is ready to close the connection, something known as a four way handshake happens. The computer ready to close the connection, sends a FIN flag, which the other computer acknowledges with an ACK flag. Then, if this computer is also ready to close the connection, which will almost always be the case. It will send a FIN flag. This is again responded to by an ACK flag. Hypothetically, a TCP connection can stay open in simplex mode with only one side closing the connection. But this isn't something you'll run into very often. Up next, I'll sock it to you, with information on TCP socket states. So many networking puns. Okay. See you there.





作为协议，TCP 建立用于发送长链数据段的连接。 您可以将其与网络模型中较低的协议进行对比。 这些包括 IP 和以太网， 它们只是发送单个数据包。 作 为 IT 支持专家， 您需要准确了解 其工作原理，以便排除网络流量可能无法按预期方式运行的问题。 TCP 建立连接的方式 是通过使用不同的 TCP 控制标志，按 非常特定的顺序使用。 在介绍如何建立和关闭连接之前， 我们先定义六个 TCP 控制标志。 我们将按照它们在 TCP 标头中出现的顺序来查看它们。 抬起头 这不一定与 设置它们的频率相同，或者它们的重要性相同。 第一个标志被称为 URG， 这是紧急的缩写。 此 处的值为 1 表示段 被认为是紧急的，并且紧急指针字段具有更多关于此的数据。 就像我们在上一个视频中提到的那样， TCP 的这个功能从来没有真正有广泛的选择，并且通常不会看到。 第二个标志是 ACK，简称确认。 此字段中的值为 1 表 示应检查确认编号字段。 第三个标志是 PSH， 这是推的缩写。 这意味着，传输设备希望接收设备 尽快将当前缓冲的数据推送到接收端的应用程序。 缓冲区是一种计算技术， 在 发送到其他地方之前，将一定量的数据保存在某个位置。 这有很多实际应用。 就 TCP 而言， 它用于更有效地发送大量数据块。 通过在缓冲区中保留一定量的数据， TCP 可以向等待它的程序提供更有意义的数据块。 但在某些情况下， 您可能会发送非常少量的信息， 您需要监听程序立即响应这些信息。 这就是推送标志的功能。 第四个标志是 RST，缩写为复位。 这意味着，TCP 连接中的某一端无 法从一系列缺少或格式错误的段中正确恢复。 这是 TCP 连接中的一个合作伙伴基本上说： “等等，我不能把你的意思放在一起， 让我们从头开始。” 第五个标志是 SYN， 它代表同步。 它在第一次建立 TCP 连接时使用，并确保接 收端知道检查序列号字段。 最后，我们的六个标志是 FIN， 这是 Finish 的简称。 当此标志设置为 1 时， 这意味着传输计算机没 有更多的数据要发送，并且连接可以关闭。 有关如何使用 TCP 控制标志的一 个很好的示例，让我们看看如何建立 TCP 连接。 计算机 A 将是 我们的传输计算机，计算机 B 将是我们的接收计算机。 若要启动该进程关闭，计算机 A， 将 TCP 段发送到计算机 B 使用此 SYN 标志设置。 这是计算机 A 的说法， “让我们建立一个连接，看看我的序列号字段， 所以我们知道这个对话的开始位置。” 然后，计算机 B 使用 TCP 段进行响应， 其中同时设置了 SYN 和 ACK 标志。 这是计算机 B 的说法，“当然， 让我们建立一个连接，我确认你的序列号。” 然后，计算机 A 只用 ACK 标志设置再次响应， 这只是说，“我确认您的确认。 让我们开始发送数据。” 我喜欢他们彼此有多礼貌 这种交换涉及具有 SYN、S YN/ACK 和 ACK 集的段， 每次在任何地方建立 TCP 连接时都会发生。 而且是如此有名，它有一个绰号。 三向握手 握手是两台设备的一种方法，以 确保它们使用相同的协议并能够相互理解。 三向握手完成后， 建立 TCP 连接。 现在，计算机 A 可以自由地向计算机 B 发送任何数据，反之亦然。 由于双方现在已经相互发送 SYN/ACK 对 ，因此处于此状态的 TCP 连接以全双工方式运行。 每个沿任一方向发送的数据段都应 由设置 ACK 字段的 TCP 数据段进行响应。 这样，对方总是知道收到了什么。 一旦 TCP 连接涉及的设备之一准备好关闭连接， 就会发生四向握手的情况。 准备关闭连接的计算机 发送 FIN 标志， 另一台计算机用 ACK 标志确认该标志。 然后，如果这台计算机也准备关闭连接， 这将几乎总是如此。 它将发送 FIN 标志。 这再次由 ACK 标志响应。 假设 TCP 连接可以在 单纯模式下保持打开状态，只有一侧关闭连接。 但这不是你经常遇到的东西。 接 下来，我会把它袜给你， 提供有关 TCP 套接字状态的信息。 这么多的网络双关语。 好的。 看到你在那里。